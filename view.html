<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Activity List</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container my-5">
  <h2 class="mb-4 text-center">Activity Records</h2>

  <table class="table table-striped table-bordered" id="activityTable">
    <thead class="table-dark">
      <tr>
        <th>Date Start</th>
        <th>Time Start</th>
        <th>Date End</th>
        <th>Time End</th>
        <th>Activity Title</th>
        <th>Target Participants</th>
        <th>Office Facilitator</th>
        <th>Remarks</th>
        <th>Link</th>
      </tr>
    </thead>
    <tbody>
      <!-- Data will load here -->
    </tbody>
  </table>

  <div class="text-center">
    <a href="<?= ScriptApp.getService().getUrl(); ?>" class="btn btn-primary">Go to Form</a>
  </div>
</div>

<script>
google.script.run.withSuccessHandler(function(data){
  var tbody = document.querySelector("#activityTable tbody");

  // skip header row (row 1 in sheet)
  for (var i = 1; i < data.length; i++) {
    var row = data[i];
    var tr = document.createElement("tr");

    // Columns (adjust indexes if your mapping changes)
    var cols = [0,1,2,3,4,5,7,9,10]; 
    cols.forEach(function(idx){
      var td = document.createElement("td");
      td.textContent = row[idx] || "";
      tr.appendChild(td);
    });

    tbody.appendChild(tr);
  }
}).getActivityData();
</script>
</body>
</html>
